# Laravel cPanel .htaccess with MIME Type Fix

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # Redirect Trailing Slashes If Not A Folder...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]

    # Handle Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]

</IfModule>

# MIME Type Configuration - CRITICAL for JavaScript modules

<IfModule mod_mime.c>
    # JavaScript files
    AddType application/javascript .js
    AddType application/javascript .mjs
    AddType module .js

    # CSS files
    AddType text/css .css

    # Font files
    AddType application/font-woff .woff
    AddType application/font-woff2 .woff2
    AddType application/x-font-ttf .ttf
    AddType application/vnd.ms-fontobject .eot

    # Image files
    AddType image/svg+xml .svg
    AddType image/webp .webp

    # JSON files
    AddType application/json .json

    # Map files
    AddType application/json .map
</IfModule>

# Force correct MIME types for JavaScript modules

<FilesMatch "\.(js|mjs)$">
ForceType application/javascript
Header set Content-Type "application/javascript"
</FilesMatch>

# Security headers

<IfModule mod_headers.c>
    # Remove server signatures
    Header always unset Server
    Header always unset X-Powered-By

    # Basic security headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"

    # Cache control for static assets
    <FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map)$">
        Header set Cache-Control "public, max-age=31536000"
        Header set Expires "Thu, 31 Dec 2037 23:55:55 GMT"
    </FilesMatch>
</IfModule>

# Compression for better performance

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/json
</IfModule>
