import{r as v,j as e,H as k,a as P}from"./app-DoPWTTfF.js";import{L}from"./Layout-DjuX2mY_.js";import{c as I,B as b}from"./button-ve-6vPrQ.js";import{C as R}from"./card-B40xIBSB.js";import{L as r,S as u,a as p,b as g,c as j,d as n}from"./select-MqY_4vRd.js";import{u as H}from"./useToast-DH2i-Qux.js";import{C as y,U as A}from"./upload-BFaA4OVZ.js";import{c as _}from"./createLucideIcon-DlXnowyG.js";import{H as O}from"./hard-drive-CtOjtOYp.js";import{S as E}from"./settings-qYtqyHtM.js";import{L as V}from"./lock-DSFTxmHq.js";/* empty css            */import"./index-C87LH4oZ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],$=_("Server",G),l=v.forwardRef(({className:N,type:m,...C},c)=>e.jsx("input",{type:m,className:I("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",N),ref:c,...C}));l.displayName="Input";function ne({setupStatus:N,phpInfo:m,systemRequirements:C}){const{toast:c}=H(),[d,S]=v.useState(0),[x,f]=v.useState(!1),[h,w]=v.useState(null),[s,t]=v.useState({dbConnection:"sqlite",dbHost:"localhost",dbPort:3306,dbDatabase:"database.sqlite",dbUsername:"",dbPassword:"",appName:"Fucking File Hosting",appUrl:window.location.origin,appEnv:"production",appDebug:!1,maxFileSize:104857600,maxFileSizeMB:100,storageDisk:"local",filesStoragePath:"storage/app/files",disableIpLogging:!0,disableUserTracking:!0,privacyMode:"strict",rateLimitingEnabled:!0,rateLimitUploads:10,rateLimitDownloads:60,defaultExpirationDays:1,allowOwnerDelete:!0,enableFileInfoPage:!0,adminName:"",adminEmail:"",adminPassword:""}),o=[{id:"requirements",title:"System Requirements",description:"Check system requirements and PHP configuration",icon:e.jsx($,{className:"h-6 w-6"}),completed:!1},{id:"database",title:"Database Configuration",description:"Configure your database connection",icon:e.jsx(O,{className:"h-6 w-6"}),completed:!1},{id:"basic",title:"Basic Configuration",description:"Configure your application settings",icon:e.jsx(E,{className:"h-6 w-6"}),completed:!1},{id:"upload",title:"Upload Settings",description:"Set file size limits and upload configuration",icon:e.jsx(A,{className:"h-6 w-6"}),completed:!1},{id:"privacy",title:"Privacy & Security",description:"Configure privacy and security settings",icon:e.jsx(V,{className:"h-6 w-6"}),completed:!1},{id:"admin",title:"Admin Account",description:"Create your administrator account",icon:e.jsx(E,{className:"h-6 w-6"}),completed:!1},{id:"complete",title:"Complete Setup",description:"Review and apply configuration",icon:e.jsx(y,{className:"h-6 w-6"}),completed:!1}],F=a=>{if(a===0)return"0 Bytes";const i=1024,q=["Bytes","KB","MB","GB"],D=Math.floor(Math.log(a)/Math.log(i));return parseFloat((a/Math.pow(i,D)).toFixed(2))+" "+q[D]},M=()=>{d<o.length-1&&S(d+1)},U=()=>{d>0&&S(d-1)},B=async()=>{f(!0),w(null);try{const i=await(await fetch("/api/setup/test-database",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({dbConnection:s.dbConnection,dbHost:s.dbHost,dbPort:s.dbPort,dbDatabase:s.dbDatabase,dbUsername:s.dbUsername,dbPassword:s.dbPassword})})).json();w(i),i.success?c({title:"Database Connection Successful",description:i.message,variant:"success"}):c({title:"Database Connection Failed",description:i.message,variant:"destructive"})}catch{const a="Failed to test database connection";w({success:!1,message:a}),c({title:"Connection Test Failed",description:a,variant:"destructive"})}finally{f(!1)}},T=async()=>{f(!0);try{const i=await(await fetch("/api/setup/save",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(s)})).json();if(i.success)c({title:"Setup Complete!",description:i.message,variant:"success"}),setTimeout(()=>{P.visit("/")},3e3);else throw new Error(i.message||"Failed to save configuration")}catch(a){const i=a instanceof Error?a.message:"Failed to save configuration. Please try again.";c({title:"Setup Failed",description:i,variant:"destructive"})}finally{f(!1)}},z=()=>{switch(o[d].id){case"requirements":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"System Requirements Check"}),e.jsx("p",{className:"text-muted-foreground",children:"Please ensure all requirements are met before proceeding."})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(C).map(([a,i])=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Current: ",i.current]})]}),e.jsx("div",{className:`rounded-full px-3 py-1 text-sm ${i.met?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i.met?"✓ Met":"✗ Failed"})]},a))}),e.jsxs("div",{className:"mt-6 rounded-lg bg-blue-50 p-4",children:[e.jsx("h4",{className:"mb-2 font-medium",children:"PHP Information"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Version: ",m.version]}),e.jsxs("div",{children:["Upload Max Filesize: ",m.settings.upload_max_filesize]}),e.jsxs("div",{children:["Post Max Size: ",m.settings.post_max_size]}),e.jsxs("div",{children:["Memory Limit: ",m.settings.memory_limit]})]})]})]});case"database":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbConnection",children:"Database Type"}),e.jsxs(u,{value:s.dbConnection,onValueChange:a=>t({...s,dbConnection:a}),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"sqlite",children:"SQLite (Recommended for shared hosting)"}),e.jsx(n,{value:"mysql",children:"MySQL"})]})]})]}),s.dbConnection==="mysql"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbHost",children:"Database Host"}),e.jsx(l,{id:"dbHost",value:s.dbHost,onChange:a=>t({...s,dbHost:a.target.value}),placeholder:"localhost"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbPort",children:"Port"}),e.jsx(l,{id:"dbPort",type:"number",value:s.dbPort,onChange:a=>t({...s,dbPort:parseInt(a.target.value)}),placeholder:"3306"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbUsername",children:"Database Username"}),e.jsx(l,{id:"dbUsername",value:s.dbUsername,onChange:a=>t({...s,dbUsername:a.target.value}),placeholder:"username"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbPassword",children:"Database Password"}),e.jsx(l,{id:"dbPassword",type:"password",value:s.dbPassword,onChange:a=>t({...s,dbPassword:a.target.value}),placeholder:"password"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dbDatabase",children:s.dbConnection==="mysql"?"Database Name":"Database File Name"}),e.jsx(l,{id:"dbDatabase",value:s.dbDatabase,onChange:a=>t({...s,dbDatabase:a.target.value}),placeholder:s.dbConnection==="mysql"?"filehosting":"database.sqlite"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(b,{onClick:B,disabled:x,variant:"outline",children:x?"Testing...":"Test Connection"}),h&&e.jsx("div",{className:`rounded-full px-3 py-1 text-sm ${h.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.success?"✓ Connected":"✗ Failed"})]}),h&&!h.success&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3",children:e.jsx("p",{className:"text-sm text-red-800",children:h.message})})]});case"basic":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"appName",children:"Application Name"}),e.jsx(l,{id:"appName",value:s.appName,onChange:a=>t({...s,appName:a.target.value}),placeholder:"Fucking File Hosting"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"appUrl",children:"Application URL"}),e.jsx(l,{id:"appUrl",value:s.appUrl,onChange:a=>t({...s,appUrl:a.target.value}),placeholder:"https://yoursite.com"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"appEnv",children:"Environment"}),e.jsxs(u,{value:s.appEnv,onValueChange:a=>t({...s,appEnv:a}),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"production",children:"Production"}),e.jsx(n,{value:"local",children:"Local Development"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"appDebug",checked:s.appDebug,onChange:a=>t({...s,appDebug:a.target.checked}),className:"rounded"}),e.jsx(r,{htmlFor:"appDebug",children:"Enable Debug Mode (only for development)"})]})]});case"upload":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"maxFileSizeMB",children:"Maximum File Size (MB)"}),e.jsxs(u,{value:s.maxFileSizeMB.toString(),onValueChange:a=>{const i=parseInt(a);t({...s,maxFileSizeMB:i,maxFileSize:i*1024*1024})},children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"10",children:"10 MB"}),e.jsx(n,{value:"25",children:"25 MB"}),e.jsx(n,{value:"50",children:"50 MB"}),e.jsx(n,{value:"100",children:"100 MB"}),e.jsx(n,{value:"500",children:"500 MB"}),e.jsx(n,{value:"1024",children:"1 GB"}),e.jsx(n,{value:"5120",children:"5 GB"}),e.jsx(n,{value:"10240",children:"10 GB"})]})]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:["Current limit: ",F(s.maxFileSize)]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"defaultExpiration",children:"Default File Expiration (Days)"}),e.jsxs(u,{value:s.defaultExpirationDays.toString(),onValueChange:a=>t({...s,defaultExpirationDays:parseInt(a)}),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"1",children:"1 Day"}),e.jsx(n,{value:"7",children:"7 Days"}),e.jsx(n,{value:"14",children:"14 Days"}),e.jsx(n,{value:"30",children:"30 Days"})]})]})]})]});case"privacy":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"storageDisk",children:"Storage Disk"}),e.jsxs(u,{value:s.storageDisk,onValueChange:a=>t({...s,storageDisk:a}),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"local",children:"Local Storage"}),e.jsx(n,{value:"public",children:"Public Storage"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"filesStoragePath",children:"Files Storage Path"}),e.jsx(l,{id:"filesStoragePath",value:s.filesStoragePath,onChange:a=>t({...s,filesStoragePath:a.target.value}),placeholder:"storage/app/files"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"mb-4 font-medium",children:"Privacy Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"disableIpLogging",checked:s.disableIpLogging,onChange:a=>t({...s,disableIpLogging:a.target.checked}),className:"rounded"}),e.jsx(r,{htmlFor:"disableIpLogging",children:"Disable IP Logging"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"disableUserTracking",checked:s.disableUserTracking,onChange:a=>t({...s,disableUserTracking:a.target.checked}),className:"rounded"}),e.jsx(r,{htmlFor:"disableUserTracking",children:"Disable User Tracking"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"privacyMode",children:"Privacy Mode"}),e.jsxs(u,{value:s.privacyMode,onValueChange:a=>t({...s,privacyMode:a}),children:[e.jsx(p,{children:e.jsx(g,{})}),e.jsxs(j,{children:[e.jsx(n,{value:"strict",children:"Strict (No logging)"}),e.jsx(n,{value:"moderate",children:"Moderate (Basic logs)"}),e.jsx(n,{value:"minimal",children:"Minimal (Error logs only)"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"mb-4 font-medium",children:"Security & Rate Limiting"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"rateLimitingEnabled",checked:s.rateLimitingEnabled,onChange:a=>t({...s,rateLimitingEnabled:a.target.checked}),className:"rounded"}),e.jsx(r,{htmlFor:"rateLimitingEnabled",children:"Enable Rate Limiting"})]}),s.rateLimitingEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"rateLimitUploads",children:"Upload Rate Limit (per minute)"}),e.jsx(l,{id:"rateLimitUploads",type:"number",value:s.rateLimitUploads,onChange:a=>t({...s,rateLimitUploads:parseInt(a.target.value)}),min:"1",max:"100"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"rateLimitDownloads",children:"Download Rate Limit (per minute)"}),e.jsx(l,{id:"rateLimitDownloads",type:"number",value:s.rateLimitDownloads,onChange:a=>t({...s,rateLimitDownloads:parseInt(a.target.value)}),min:"1",max:"1000"})]})]})]})]})]});case"admin":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"Create Administrator Account"}),e.jsx("p",{className:"text-muted-foreground",children:"This account will have full access to manage your file hosting service."})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"adminName",children:"Full Name"}),e.jsx(l,{id:"adminName",value:s.adminName,onChange:a=>t({...s,adminName:a.target.value}),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"adminEmail",children:"Email Address"}),e.jsx(l,{id:"adminEmail",type:"email",value:s.adminEmail,onChange:a=>t({...s,adminEmail:a.target.value}),placeholder:"admin@yoursite.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"adminPassword",children:"Password"}),e.jsx(l,{id:"adminPassword",type:"password",value:s.adminPassword,onChange:a=>t({...s,adminPassword:a.target.value}),placeholder:"Enter a strong password",minLength:8,required:!0}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Password must be at least 8 characters long."})]})]});case"complete":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"mx-auto mb-4 h-16 w-16 text-green-500"}),e.jsx("h3",{className:"mb-2 text-2xl font-bold",children:"Setup Complete!"}),e.jsx("p",{className:"mb-6 text-muted-foreground",children:'Review your configuration below and click "Apply Configuration" to complete the setup.'})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"App Name:"})," ",s.appName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Environment:"})," ",s.appEnv]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Database:"})," ",s.dbConnection.toUpperCase()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Max File Size:"})," ",F(s.maxFileSize)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Storage:"})," ",s.storageDisk]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Privacy Mode:"})," ",s.privacyMode]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rate Limiting:"})," ",s.rateLimitingEnabled?"Enabled":"Disabled"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Default Expiration:"})," ",s.defaultExpirationDays," days"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Admin Email:"})," ",s.adminEmail]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[e.jsx("h4",{className:"mb-2 font-medium text-yellow-800",children:"Important Notes:"}),e.jsxs("ul",{className:"space-y-1 text-sm text-yellow-700",children:[e.jsx("li",{children:"• The setup will create database tables and configure your application"}),e.jsx("li",{children:"• Your admin account will be created with the provided credentials"}),e.jsx("li",{children:"• Make sure to backup your database before making changes"}),e.jsx("li",{children:"• You can modify these settings later through the admin panel"})]})]})]})]});default:return null}};return N.is_completed?e.jsxs(L,{children:[e.jsx(k,{title:"Setup Complete"}),e.jsxs("div",{className:"container mx-auto max-w-2xl px-4 py-8 text-center",children:[e.jsx(y,{className:"mx-auto mb-4 h-16 w-16 text-green-500"}),e.jsx("h1",{className:"mb-4 text-3xl font-bold",children:"Setup Already Complete"}),e.jsx("p",{className:"mb-6 text-muted-foreground",children:"Your file hosting application is already configured and ready to use."}),e.jsx(b,{onClick:()=>P.visit("/"),children:"Go to Application"})]})]}):e.jsxs(L,{children:[e.jsx(k,{title:"Setup Wizard"}),e.jsxs("div",{className:"container mx-auto max-w-4xl px-4 py-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"Setup Wizard"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure your file hosting application in a few simple steps"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:o.map((a,i)=>e.jsxs("div",{className:`flex items-center ${i<o.length-1?"flex-1":""}`,children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full border-2 ${i<=d?"border-primary bg-primary text-primary-foreground":"border-muted-foreground text-muted-foreground"}`,children:i<d?e.jsx(y,{className:"h-5 w-5"}):a.icon}),i<o.length-1&&e.jsx("div",{className:`mx-4 h-0.5 flex-1 ${i<d?"bg-primary":"bg-muted"}`})]},a.id))}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:o[d].title}),e.jsx("p",{className:"text-muted-foreground",children:o[d].description})]})]}),e.jsx(R,{className:"mb-8 p-6",children:z()}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{variant:"outline",onClick:U,disabled:d===0||x,children:"Previous"}),d===o.length-1?e.jsx(b,{onClick:T,disabled:x,className:"bg-gradient-primary",children:x?"Setting up...":"Complete Setup"}):e.jsx(b,{onClick:M,disabled:x,children:"Next"})]})]})]})}export{ne as default};
